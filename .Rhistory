source('delphi_epidata.R')
# Import
source('./delphi_epidata.R')
getwd()
source('./R/delphi_epidata.R')
res <- Epidata$covidcast('fb-survey', 'smoothed_cli', 'day', 'county', list(20200401, Epidata$range(20200405, 20200414)), '06001')
cat(paste(res$result, res$message, length(res$epidata), "\n"))
View(res)
View(Epidata)
View(res)
View(Epidata)
load("~/git/fluhosp2021-2022/R/hub_locations.rda")
View(hub_locations)
load("~/git/fluhosp2021-2022/R/fluhosp_locations.rda")
View(hub_locations)
library(dplyr)
View(hub_locations)
fluhosp_locations <- hub_locations %>%
dplyr::filter(grep("county",location_name))
fluhosp_locations <- hub_locations %>%
dplyr::filter(location_name %in% location_name[which(grep("county",location_name))])
fluhosp_locations <- hub_locations %>%
dplyr::filter(!str_detect(location_name,"county"))
library(tidyverse)
fluhosp_locations <- hub_locations %>%
dplyr::filter(!str_detect(location_name,"county"))
View(fluhosp_locations)
fluhosp_locations <- hub_locations %>%
dplyr::filter(!str_detect(location_name,"County"))
save(fluhosp_locations,file="fluhosp_locations.Rdata")
load("~/git/fluhosp2021-2022/R/fluhosp_locations.Rdata")
View(fluhosp_locations)
res <- Epidata$covid_hosp()
# for now default source to epidata
source('./R/delphi_epidata.R')
res <- Epidata$covid_hosp()
res <- Epidata$covid_hosp("MA",20200510)
View(res)
res <- Epidata$covid_hosp("MA",20200510)[[1]]
View(res)
res <- Epidata$covid_hosp("MA",20200510)
View(res)
check <- res[[1]][[1]]
View(check)
check[34]
res <- Epidata$covid_hosp("MA",c(20200510,20210510))
View(res)
View(check)
View(res)
check <- unlist(res[[1]])
check <- lapply(res[[1]], function(x) data.frame(x))
res[[1]][[1]]
class(res[[1]][[1]])
unlist(res[[1]][[1]])
data.frame(res[[1]][[1]])
data.frame(unlist(res[[1]][[1]]))
data.frame(t(unlist(res[[1]][[1]])))
check1<-data.frame(t(unlist(res[[1]][[1]])))
View(check1)
check <- lapply(res[[1]], function(x) data.frame(t(unlist(x))))
View(check)
View(check1)
View(check)
diff(check[[1]],check[[2]])
diff(colnames(check[[1]]),colnames(check[[2]]))
colnames(check[[1]])
setdiff(colnames(check[[1]]),colnames(check[[2]]))
View(check)
setdiff(colnames(check[[2]]),colnames(check[[1]]))
res2 <- Epidata$covid_hosp("MA",c(20200510,20210510)) %>%
lapply(., function(x) data.frame(t(unlist(x))))
View(res2)
res2 <- Epidata$covid_hosp("MA",c(20200510,20210510))[[1]] %>%
lapply(., function(x) data.frame(t(unlist(x))))
View(res2)
View(res)
res2 <- Epidata$covid_hosp("MA",c(20200510,20210510))['epidata'] %>%
lapply(., function(x) data.frame(t(unlist(x))))
View(res2)
res2 <- Epidata$covid_hosp("MA",c(20200510,20210510))[['epidata']] %>%
lapply(., function(x) data.frame(t(unlist(x))))
View(res2)
check2 <- Epidata$covid_hosp(locs,tdates)[['epidata']] %>%
lapply(., function(x) data.frame(t(unlist(x)))) %>%
map_dfr(., ~ .x %>%
as.list %>%
as_tibble)
check2 <- Epidata$covid_hosp("MA",c(20200510,20210510))[['epidata']] %>%
lapply(., function(x) data.frame(t(unlist(x)))) %>%
map_dfr(., ~ .x %>%
as.list %>%
as_tibble)
View(check2)
